# Web Application Vulnerability Scanner

## Overview

The `Scanner` class is designed for penetration testing, specifically for scanning and identifying vulnerabilities such as Cross-Site Scripting (XSS) in web applications. The script utilizes Python libraries such as `requests`, `re`, `urllib.parse`, and `BeautifulSoup` for HTTP requests, HTML parsing, and form manipulation.

## Dependencies

- `requests`: For making HTTP requests.
- `re`: For using regular expressions.
- `urllib.parse`: For URL parsing and manipulation.
- `bs4` (BeautifulSoup): For parsing HTML content.
- `ansi_colors`: For colored terminal output.

## Usage

The script is intended to be run from the command line. It requires the target URL and optionally a list of links to ignore during the scan.

## Class: Scanner

### `__init__(self, url, ignore_links)`

- Initializes a new `Scanner` instance.
- Parameters:
  - `url` (str): The target URL to scan.
  - `ignore_links` (list): A list of links to ignore during the scan.

### `extract_links_from(self, url)`

- Extracts all href links from the given URL.
- Parameters:
  - `url` (str): The URL from which to extract links.
- Returns:
  - `list`: A list of extracted links.

### `crawl(self, url=None)`

- Recursively crawls the target URL to discover all linked pages.
- Parameters:
  - `url` (str, optional): The URL to start crawling from. Defaults to the target URL.

### `extract_forms(self, url)`

- Extracts all forms from the given URL.
- Parameters:
  - `url` (str): The URL from which to extract forms.
- Returns:
  - `list`: A list of extracted forms.

### `submit_form(self, form, value, url)`

- Submits a form with the given value.
- Parameters:
  - `form` (bs4.element.Tag): The form to submit.
  - `value` (str): The value to insert into form fields.
  - `url` (str): The URL from which the form was extracted.
- Returns:
  - `requests.Response`: The response from the form submission.

### `run_scanner(self)`

- Runs the scanner on the target URL, testing forms and links for XSS vulnerabilities.

### `test_xss_in_form(self, form, url)`

- Tests a form for XSS vulnerability by injecting a test script.
- Parameters:
  - `form` (bs4.element.Tag): The form to test.
  - `url` (str): The URL from which the form was extracted.
- Returns:
  - `bool`: True if the form is vulnerable to XSS, otherwise False.

### `test_xss_in_link(self, url)`

- Tests a link for XSS vulnerability by injecting a test script.
- Parameters:
  - `url` (str): The URL to test.
- Returns:
  - `bool`: True if the link is vulnerable to XSS, otherwise False.

## Example Usage

```python
if __name__ == "__main__":
    target_url = "http://example.com"
    ignore_links = ["http://example.com/logout"]
    
    scanner = Scanner(target_url, ignore_links)
    scanner.crawl()
    scanner.run_scanner()
```

## Notes

- Ensure that you have the required dependencies installed.
- Use responsibly and with permission on target systems.
  
